<!DOCTYPE HTML>
<!--
	Twenty by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		{% load staticfiles %}
		<script>
			var mobileStyle = '{% static 'events/css/style-mobile.css' %}';
			var style = '{% static 'events/css/style.css' %}';
			var wideStyle = '{% static 'events/css/style-wide.css' %}';
			var narrowStyle = '{% static 'events/css/style-narrow.css' %}';
			var narrowerStyle = '{% static 'events/css/style-narrower.css' %}';
			var normalStyle = '{% static 'events/css/style-normal.css' %}';;
		</script>

		<title>Skedg - Let us check your skedg! </title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="{% static 'events/js/jquery.min.js' %}"></script>
		<script src="{% static 'events/js/jquery.dropotron.min.js' %}"></script>
		<script src="{% static 'events/js/jquery.scrolly.min.js' %}"></script>
		<script src="{% static 'events/js/jquery.scrollgress.min.js' %}"></script>
		<script src="{% static 'events/js/skel.min.js' %}"></script>
		<script src="{% static 'events/js/skel-layers.min.js' %}"></script>
		<script src="{% static 'events/js/init.js' %}"></script>
		<noscript>
			<link rel="stylesheet" href="{% static 'events/css/skel.css' %}" />
			<link rel="stylesheet" href="{% static 'events/css/style.css' %}" />
			<link rel="stylesheet" href="{% static 'events/css/style-wide.css' %}" />
			<link rel="stylesheet" href="{% static 'events/css/style-noscript.css' %}" />
		</noscript>
		<script type="text/javascript">
			{% if messages %}
				//Created event
				{% for message in messages %}
					alert('{{message}}');
				{% endfor %}
			{% endif %}
		</script>

		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie/v9.css" /><![endif]-->
	</head>
	<body class="no-sidebar">

		<!-- Header -->
			<header id="header" class="skel-layers-fixed">
				{% if user.is_authenticated %}
				<h1 id="logo"><a href="/">Skedg <span> - Hello, {{ user.first_name }}! </span></a></h1>
				{% else %}
				<h1 id="logo"><a href="/">Skedg <span> - Let us check your schedule!  </span></a></h1>
				{% endif %}
				<nav id="nav">
					<ul>
						<li ><a href="/">Home</a></li>
						{% if user.is_authenticated %}		
						<li><a class="special button" href="/events/logout/">Logout</a></li>
						{% else %}
						<li><a href="javascript:void(0);" id="trigger-overlay" class="links button special ">Login</a></li>
						<li><a href="javascript:void(0);" id="trigger-overlay-two" class="links button special ">Register</a></li>
						{% endif %}
						
					</ul>
				</nav>
			</header>

		<!-- Loading Overlay -->
			<div class="loading" id="loadingOverlay" style="display:none">Loading&#8230;</div>
		
		<!-- Main -->
			<article id="main">
				<div class="content">
					<section>
						<link rel="stylesheet" type="text/css" href="{% static 'events/css/normalize.css' %}" />
						<link rel="stylesheet" type="text/css" href="{% static 'events/css/demo.css' %}" />

						<!-- open/close -->
						<br />
						<div class="overlay overlay-hugeinc">
							<button type="button" class="overlay-close">Close</button>
							<div class="register"> <br/ >
								<div id = "id_of_div" class ="divs">
									<!-- <h2><strong><center>Login to your account</center></strong></h2> -->
									<form method="post" id="login_form" action="/events/loginEvent/">
										{% csrf_token %}
										<center><label for="username">Username</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%;" type="text" size="30" name="username" value="{{username}}"id="username" />
										<center><label for="password">Password</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%" type="password" name="password" id="password" size="25" />
										<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}" id="eventID"></input></span>
										<p><center><input type="submit" value="submit" name="submit" id="submit" class="button special" /></center></p>
									</form>
									<font color='red'>{{invalidLogin}}</font>
								</div>
							</div>
						</div>

						<div class="overlay2 overlay-hugeinc">
							<button type="button" class="overlay-close">Close</button>
							<div class="register"> <br/ >
								<div id = "id_of_div2" class="divs">
				
									<form id="user_form" method="post" action="/events/registerEvent/" enctype="multipart/form-data" style:"margins: auto;">
									  	{% csrf_token %}
										<center><label for="name">First Name</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%"; type="text" name="first_name" id="first_name" value="{{first_name}}" size="30" />
										<center><label for="name">Last Name</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%"; type="text" name="last_name" id="last_name" value="{{last_name}}" size="30" />
										<center><label for="username">Email Address</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%;" type="text" size="30" name="username" value="{{email}}" id="username" />
										<center><label for="password">Password</label></center><input style="border:1px solid #000000; margin: 0 auto; margin-bottom: 10px; width: 60%" type="password" name="password" id="password" size="25" />
										<center><label for="password">Confirm Password</label></center><input style="border:1px solid #000000; margin: 0 auto; width: 60%; height: 10%;" type="password" name="password2" id="password2" size="25" />
										<p><center><input type="submit" value="Register" name="submit" id="register" class="button special" /></center></p>
									</form>
								</div>
							</div>
						</div>

						<link rel="stylesheet" href="{% static 'events/css/skel.css' %}" />
						<link rel="stylesheet" href="{% static 'events/css/style.css' %}" />
						<link rel="stylesheet" href="{% static 'events/css/style-wide.css' %}" />

					</section>
				</div>

				<!-- One -->
					<section class="wrapper style4 container">

						<!-- Content -->
							<div class="content" style="margin-top: 30px;">
								<section>
									<!-- <div class="navbarBody"> -->
										<div class="navbar">
											<div class="eventLink" align="left">
												<strong>EVENT LINK: &nbsp; </strong>
												<input value="skedg.tk:82/events/eventDetails/{{ event.eventID }}" readonly rows="1" cols="15" wrap="off" size="40" onClick="this.select();" style="resize:none; overflow-x:hidden;  display: inline-block; padding: 5px;"></input>
											</div>
											<ul id="nav">
													{% if event.creator == user.username %}
														<li>
															<form style="display: inline-block;" action="{% url 'events:manageCreator' %}" method="post">
																{% csrf_token %}
																<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></input></span>
																
																<button class="special button" style="margin-right: -5px; background-color: #4682B4; border-color: #4682B4; border-radius: 5px;" type="submit" name="delete">Delete Event</button>
															</form>
														</li>
													{% elif user.is_authenticated %}
														<li>
															<form action="{% url 'events:manageInvitee' %}" method="post">   
																	{% csrf_token %}
																	<span style="display: none;"><input type="text" name="username" value="{{ user.username }}"/></input></span>    
																	<span style="display: none;"><input type="text" name="firstName" value="{{ user.first_name }}"/></input></span>    
																	<span style="display: none;"><input type="text" name="lastName" value="{{ user.last_name }}"/></input></span>     
																	<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></input></span> 
																	<span id="submitButton"></span>
																	</form>
															<script>
																var leaveForm = false;
															</script>
															{% for i in event.invitee_set.all %}
																{% if user.username == i.name %}
																	
																	<script>
																		leaveForm = true;
																		document.getElementById("submitButton").innerHTML = "<button class='special button' id='join' style='margin-right: -5px; background-color: #4682B4; border-color: #4682B4; border-radius: 5px; '' type='submit' name='decline'>Leave Event</button>";
																	</script>
																
																{% endif %}
															{% endfor %}

															<script>
																if (leaveForm == false)
																	document.getElementById("submitButton").innerHTML = "<button class='special button' id='join' style='margin-right: -5px; background-color: #4682B4; border-color: #4682B4; border-radius: 5px; '' type='submit' name='join'>Join Event</button>";
															</script>												
															
														</li>
														<!-- WE NEED THIS TO BE LEAVE EVENT!!!!! -->
													{% else %}
														<!-- <form action="{% url 'events:manageInvitee' %}" method="post">   
															{% csrf_token %}
															<span style="display: none;"><input type="text" name="username" value="{{ user.username }}"/></input></span>     
															<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></input></span>  -->

															<li><button class="button" id="join2" style="font-size: 9pt; margin-right: -5px; background-color: #ff9999; border-color: #ff9999; border-radius: 5px;" name="join2">Login to Join</button></li>
														<!-- </form> -->
													{% endif %}
											</ul>						
										</div>
									<!-- </div> -->
									<div class = "eventContainer">
										<div class="row">
											<div class="6u 12u(narrower)">
												<div class="column1" align ="left" style="padding-left: 50px;">
													<header align="left">
														<h2><strong>{{ event.title }}</strong></h2>
													</header>
												
													<strong>HOST</strong>: {{ event.creatorName }} <br />
													{{ event.desc }} <br/>
													<strong> TIME: </strong>
														{% if event.is_scheduled %}
															{{event.printScheduledTime}}
														{% else %}
															<font color="red">NOT SKEDULED </font>
														{% endif %}
														<br /> <br />
													<header align="left">
														<h3><strong>Invitees</strong></h3>
													</header>
													<div class="bumping">
													{% for invitee in event.invitee_set.all %}
														<!-- Bumps -->
														{% if event.creator == user.username %}
															<form action="{% url 'events:manageCreator' %}" method="post"> 
															{% csrf_token %} 
															<span style="display: none;"><input type="text" name="invitee_name" value="{{ invitee.name }}"/></input></span> 
															<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"/></input></span>
															<button style="float: left; text-align; left; background: transparent;  color: red; display: inline-block; padding: 0; margin: 0; margin-top: 5px; font-size: 16px; margin-left: 5px; padding-right: 3px;" type="submit" name="boot" id="boot">✖</button>
															</form>
														{% endif %}

														{{ invitee }} <br/>
													{% endfor %}
													</div>
												</div>
											</div>
											<div class="6u 12u(narrower)">
												<section>
													<div id="messagesContainer">
														<div id="messagesTitle" style="vertical-align: middle">
														<header>
														<h1 style="font-weight: 300; line-height: 1.75em; margin-bottom: 1em; text-transform: uppercase; font-size: 18pt"><strong>MESSAGE BOARD</strong></h1>
														</header>
														</div>
														<div id="messagesBody">
															<ul>
															{% for m in event.message_set.all %}
																<li>
																{% if event.creator = user.username %}
																	<form action="{% url 'events:manageMessage' %}" method="post">
																		{% csrf_token %}
																		<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></span>
																		<span style="display: none;"><input type="text" name="username" value="{{ m.author }}"></span>
																		<span style="display: none;"><input type="text" name="messageID" value="{{ m.id }}"></span>
																		<button type="submit" name="erase">✖</button> 
																	</form>
																{% endif %}
																
																{{ m.text }}<br /> <br />
																<div align="right" style="padding-right: 3px;"><span style="font-size:13px; color:#999999;"> {{m.firstName}} {{m.lastName}}, {{m.printPubDate}}</span> </div>

																
																</li>
															{% endfor %}
															</ul>
														</div>
														<div id="messagesFooter">
															<form action="{% url 'events:manageMessage' %}" method="post">
																{% csrf_token %}
																<textarea name="message" style="resize: none; display: inline-block;" rows="2"></textarea>
																<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></span>
																<span style="display: none;"><input type="text" name="username" value="{{ user.username }}"></span>
																<span style="display: none;"><input type="text" name="firstName" value="{{ user.first_name }}"></span>
																<span style="display: none;"><input type="text" name="lastName" value="{{ user.last_name }}"></span>
																<input class="button special" style="margin-top: 5px;" type="submit" name="write" value="Post"/> </input>
															</form>
														</div>
													</div>
												</section>

											</div>
										</div>

										<!-- why is this section friends -->
										<!-- should only show if in event or is creator -->
										<!-- creator view -->
										{% if event.creator == user.username %}
											<section id="friends">
											<div class="row" style="margin-top: -100px">
												{% if event.posstime_set.all|length == 0 %}
														<p> Event has been skedguled! </p>
												{% endif %}

												{% for time in event.posstime_set.all %}
													{% if forloop.counter <= 3 %}
														<div class="4u 12u(narrower)">
															<section style="background-color: #645862; border-radius: 10px; padding:5px;"><form action="{% url 'events:manageCreator' %}" method="post">
																{% csrf_token %}
																<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"</input></span>
																<span style="display: none;"><input type="text" name="skedgeTime" value="{{ time.id }}"</input></span>
																<button class="icon fa-clock-o" background-color: #4682B4; border-color: #4682B4; type="submit" name="skedg"></button>
																<header>
																	<h3> {{ time.date }} </h3>
																	<p> {{ time.time }} </p>
																	<p> {{ time.people }} </p>
																</header>
															</form></section>
														</div>
													{% endif %}
												{% endfor %}
											</div>
											</section>
										{% else %}
											<!-- invitee view -->
											<section id="friends">
												{% for i in event.invitee_set.all %}
													{% if i.name == user.username %}
														<form action="{% url 'events:manageInvitee' %}" method="post">
															{% csrf_token %}
															<span style="display: none;"><input type="text" name="eventID" value="{{ event.eventID }}"></input></span>
															<span style="display: none;"><input type="text" name="username" value="{{ user.username }}"></input></span>
															<span style="display: none;"><input type="text" name="firstName" value="{{ user.first_name }}"></input></span>
															<span style="display: none;"><input type="text" name="lastName" value="{{ user.last_name }}"></input></span>
														
															<div class="row">
																{% for time in event.posstime_set.all %}
																	{% if forloop.counter <= 3 %}
																		<div class="4u 12u(narrower)">
																			<section style="background-color: #645862; border-radius: 10px;">
																				<span class="icon fa-clock-o"></span>
																				<header>
																					<input type="checkbox" name="vetoTimes" value="{{ time.id }}"/>
																					<h3> {{ time.date }} </h3>
																					<p> {{ time.time }} </p>
																				</header>
																			</section>
																		</div>
																	{% endif %}
																{% endfor %}
																
																{% if event.posstime_set.all|length == 1 %}
																<div class="4u 12u(narrower)">
																<section style="background-color: #645862; opacity: 0.6">
																</section>
																</div>
																<div class="4u 12u(narrower)">
																<section style="background-color: #645862; opacity: 0.6">
																</section>
																</div>
																{% endif %}
																{% if event.posstime_set.all|length == 2 %}
																<div class="4u 12u(narrower)">
																<section style="background-color: #645862; opacity: 0.6">
																</section>
																</div>
																{% endif %}
															</div>
																{% if event.posstime_set.all|length == 0 %}
																	<p> No times found. </p>
																{% else %}
																	<input class="button special" type="submit" name="veto" value="add conflict" id="veto"/>
																{% endif %}
														</form>
													{% endif %}
												{% endfor %}
											</section>
										{% endif %}

										
									</div>
								</section>
							</div>
					</section>
			</article>

			<section id="cta">
				<header>
					<h2>Please give us your <strong>feedback</strong>!</h2>
				</header>
				<footer>
					<ul class="buttons">
						<li><a href="http://goo.gl/forms/yFULhAFLJk" class="button"> Send suggestions </a></li>
					</ul>
				</footer>
			</section>

		<!-- Save overlays on reload -->
		<script type='text/javascript'>
			$(document).ready(function(){
				{% if not messages and not invalidLogin %}
					//Good
					if (typeof sessionStorage['eventPage'] == 'string'){
						sessionStorage['eventPage'] = '0';
					}
				{% endif %}
				if (typeof sessionStorage['eventPage'] == 'string' && $.inArray(sessionStorage['eventPage'], ['1', '2']) > -1) {
					if (sessionStorage['eventPage'] == '1') {
						toggleOverlay();
					}
					else {
						toggleOverlay2();
					}
				}
			});
		</script>

		<script>
			$(document).ready(function(){
			    $("#join").click(function() {
				    $("#loadingOverlay").show();
				});
				$("#veto").click(function() {
				    $("#loadingOverlay").show();
				});
				$("#boot").click(function() {
				    $("#loadingOverlay").show();
				});
			});	
		</script>

		<script src="{% static 'events/js/modernizr.custom.js' %}"></script>
		<script src="{% static 'events/js/classie.js' %}"></script>
		<script src="{% static 'events/js/demo3.js' %}"></script>
	</body>
</html>